{% extends 'mtp_common/mtp_base.html' %}
{% load i18n %}
{% load mtp_common %}

{% block body_end %}
  <script src="{% url 'js-i18n' %}?{{ APP_GIT_COMMIT_SHORT }}"></script>
  {{ block.super }}
  <!--[{{ request.resolver_match.url_name }}]-->
  {% sentry_js %}
{% endblock %}

{% block page_title %}{% trans 'Digital cashbook' %}{% endblock %}
{% block proposition %}{% trans 'Digital cashbook' %}{% endblock %}


{% block proposition_extra %}
  <nav id="mtp-proposition-extra" class="column-full print-hidden">
    {% if request.user.is_authenticated %}
      <form class="mtp-proposition-tab-column mtp-nav-search" method="get" action="{% url 'search' %}">
        <div class="form-group">
          <label class="visually-hidden" for="id_search">{% trans 'Search all credits' %}</label>
          <input id="id_search" class="form-control" name="search" value="{{ search_field.value|default_if_none:'' }}" placeholder="{% trans 'Search all credits' %}â€¦ {% trans 'e.g. by prisoner number' %}" required/>
          <button type="submit">{% trans 'Search' %}</button>
        </div>
      </form>
    {% endif %}

    {% spaceless %}
      <ul id="mtp-proposition-tabs" class="{% if request.user.is_authenticated %}mtp-proposition-tab-column{% endif %}">
        {% if request.user.is_authenticated %}
          {% include 'cashbook/includes/proposition-tab.html' with view_name='new-credits' subview_names='new-credits' link_text=_('New credits') %}
          {% include 'cashbook/includes/proposition-tab.html' with view_name='processed-credits-list' subview_names='processed-credits-list processed-credits-detail' link_text=_('Processed credits') %}
        {% else %}
          {% include 'cashbook/includes/proposition-tab.html' with view_name='login' subview_names='login' link_text=_('Sign in') %}
        {% endif %}
        {% include 'cashbook/includes/proposition-tab.html' with view_name='submit_ticket' subview_names='submit_ticket feedback_success' link_text=_('Get help') %}
        {% if request.user.is_authenticated %}
          <li class="mtp-nav-search__trigger"><a href="#"><span class="visually-hidden">{% trans 'Search all credits' %}</span></a></li>
        {% endif %}
      </ul>
    {% endspaceless %}
  </nav>
{% endblock %}


{% block footer_support_links %}
  <ul>
    <li><a href="{% url 'submit_ticket' %}">{% trans 'Get help' %}</a></li>
    <li>
      {% trans 'Built by' %}
      <a href="https://mojdigital.blog.gov.uk/">
        <abbr title="{% trans 'Ministry of Justice' %}">MOJ</abbr> Digital
      </a>
    </li>
  </ul>
{% endblock %}
